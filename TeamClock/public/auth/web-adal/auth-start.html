<!DOCTYPE html>
<html>

<body>
  <script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.17/js/adal.min.js" crossorigin="anonymous"></script>
  <script type="text/javascript">

    // ADAL.js configuration
    let config = {
      clientId: "a842abce-51a3-4ca8-9061-86be678fb773",
      redirectUri: window.location.origin + "/TeamClock/auth/web-adal/auth-end.html",
      cacheLocation: "localStorage",
      endpoints: {
        "https://graph.microsoft.com": "https://graph.microsoft.com"
      }
    };

    // add extra query parameters Azure AD login request
    // check if consent required for new permission
    if (getUrlParameter('prompt') !== "") {
      config.extraQueryParameters += "&prompt=" + getUrlParameter('prompt');
    }

    // override URL to Azure AD auth endpoint to include extra query parameters
    config.displayCall = function (urlNavigate) {
      if (urlNavigate) {
        if (config.extraQueryParameters) {
          urlNavigate += "&" + config.extraQueryParameters;
        }
        window.location.replace(urlNavigate);
      }
    }

    // login
    let authContext = new AuthenticationContext(config);
    authContext.clearCache();
    authContext.login();

    function getUrlParameter(name) {
      name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
      var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
      var results = regex.exec(location.search);
      return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    };
  </script>
</body>

</html>\